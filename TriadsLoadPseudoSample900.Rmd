---
title: "TriadsLoadDistribution"
author: "Daxing Xu"
date: "11/30/2020"
output: html_document
---

## Data import subset

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(RColorBrewer)
df <- read.table("mergedTriadsBlock.txt.gz",header = T, sep = "\t")
df$Group <- factor(df$Group, levels = c("WE_AT","DE_AT","FT_AT","LR","CL"))
df$AdditiveOrDominance <- factor(df$AdditiveOrDominance, levels=c("additive","dominance"))
group2=ifelse(nchar(as.character(df$Group))==2, "hexaploid", "pseudohexaploid")
df <- df %>% 
  mutate(group2=group2)
df$group2 <- factor(df$group2, levels = c("pseudohexaploid","hexaploid"))
col <- c("#bdbdbd","#5ab4ac")
```

## Load distribution of additive and dominance model

### T000002

#### slightly

```{r}
df_slightly <- df %>% 
  filter(SlightlyOrStrongly=="slightly")

## distribution
ggplot(df_slightly, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Slightly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.45,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_slightly, aes(x=AdditiveOrDominance, y=T000002, fill=group2))+
  geom_boxplot(position = position_dodge(0.8))+
  labs(y="Slightly load")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  stat_summary(geom = "point",fun = mean, position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.85,0.9),legend.title = element_blank(), text = element_text(size = 16),
        axis.title.x = element_blank())


ggplot(df_slightly, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(AdditiveOrDominance~Group, scales = "free_y")+
  labs(x="Slightly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))

```

#### strongly

```{r}
df_strongly <- df %>% 
  filter(SlightlyOrStrongly=="strongly")

ggplot(df_strongly, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Strongly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.75,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_strongly, aes(x=AdditiveOrDominance, y=T000002, fill=group2))+
  geom_boxplot()+
  labs(y="Strongly load")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  stat_summary(geom = "point",fun = mean, position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.85,0.9),legend.title = element_blank(), text = element_text(size = 16),
        axis.title.x = element_blank())

ggplot(df_strongly, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(AdditiveOrDominance~Group, scales = "free_y")+
  labs(x="Strongly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))
```

#### Strongly load dominance

```{r}
df_strongly_dominance <- df %>% 
  filter(SlightlyOrStrongly=="strongly") %>% 
  filter(AdditiveOrDominance=="dominance")

ggplot(df_strongly_dominance, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  # facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Strongly load (Dominance)",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.75,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_strongly_dominance, aes(x=T000002, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(.~Group, scales = "free_y")+
  labs(x="Strongly load (Dominance)",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,0.4,by = 0.2))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))
```

### T013559 Q gene

#### Slightly

```{r}
df_slightly <- df %>% 
  filter(SlightlyOrStrongly=="slightly")
ggplot(df_slightly, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Slightly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.45,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_slightly, aes(x=AdditiveOrDominance, y=T013559, fill=group2))+
  geom_boxplot()+
  # facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(y="Slightly load")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  stat_summary(geom = "point",fun = mean, position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.85,0.9),legend.title = element_blank(), text = element_text(size = 16),axis.title.x = element_blank())

ggplot(df_slightly, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(AdditiveOrDominance~Group, scales = "free_y")+
  labs(x="Slightly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,8,by = 3))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))
```

#### Strongly

```{r}
df_strongly <- df %>% 
  filter(SlightlyOrStrongly=="strongly")

ggplot(df_strongly, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Strongly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.75,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_strongly, aes(x=AdditiveOrDominance, y=T013559, fill=group2))+
  geom_boxplot()+
  # facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(y="Strongly load")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  stat_summary(geom = "point",fun = mean, position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.85,0.9),legend.title = element_blank(), text = element_text(size = 16),axis.title.x = element_blank())


ggplot(df_strongly, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(AdditiveOrDominance~Group, scales = "free_y")+
  labs(x="Strongly load",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))
```

#### Strongly load dominance

```{r}
df_strongly_dominance <- df %>% 
  filter(SlightlyOrStrongly=="strongly") %>% 
  filter(AdditiveOrDominance=="dominance")

ggplot(df_strongly_dominance, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  # facet_wrap(AdditiveOrDominance~., scales = "free_y",ncol = 1)+
  labs(x="Strongly load (Dominance)",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  # scale_y_continuous(breaks = seq(0,2,by = 1))+
  theme_minimal()+
  theme(legend.position = c(0.75,0.9),legend.title = element_blank(), text = element_text(size = 16))

ggplot(df_strongly_dominance, aes(x=T013559, color=group2, fill=group2))+
  geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  # geom_density(alpha=0.2, aes(y=..density..))+
  facet_grid(.~Group, scales = "free_y")+
  labs(x="Strongly load (Dominance)",y="Density")+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  scale_x_continuous(breaks = seq(0,0.4,by = 0.2))+
  theme_minimal()+
  theme(legend.position = "none",legend.title = element_blank(), text = element_text(size = 16))
```

#### Q gene eightModel

```{r}
df_eightModel <- read.table("mergedTriadsBlockWithEightModel.txt.gz",header = T,sep = "\t")
df_eightModel$Group <- factor(df_eightModel$Group, levels = c("WE_AT","DE_AT","FT_AT","LR","CL"))
group2=ifelse(nchar(as.character(df_eightModel$Group))==2, "hexaploid", "pseudohexaploid")
df_eightModel <- df_eightModel %>% 
  mutate(group2=group2)
df_eightModel$group2 <- factor(df_eightModel$group2, levels = c("pseudohexaploid","hexaploid"))
```

##### Slightly load model

```{r}
df_slightly_model <- df_eightModel %>% 
  filter(SlightlyOrStrongly=="slightly")

ggplot(df_slightly_model,aes(x=T013559, fill=group2, color=group2))+
  geom_bar(alpha=0.5,aes(y = ..prop.., group=group2))+
  facet_grid(.~group2)+
  scale_x_discrete(label=c("M000","M100","M010","M001","M110","M101","M011","M111"))+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  labs(x="Slightly load model (Q gene)")+
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 30,hjust = 0, vjust =0), text = element_text(size = 14), legend.title = element_blank(),
        legend.position = "none")
  
```

##### Strongly load model

```{r}
df_strongly_model <- df_eightModel %>% 
  filter(SlightlyOrStrongly=="strongly")

ggplot(df_strongly_model,aes(x=T013559, fill=group2, color=group2))+
  geom_bar(alpha=0.5,aes(y = ..prop.., group=group2))+
  facet_grid(.~group2)+
  scale_x_discrete(label=c("M000","M100","M010","M001","M110","M101","M011","M111"))+
  scale_color_manual(values = col)+
  scale_fill_manual(values = col)+
  labs(x="Strongly load model (Q gene)")+
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45,hjust = 1, vjust =1), text = element_text(size = 14),
        legend.title = element_blank(),
        legend.position = "none")
```

## Triads block genoyped gene number model

```{r}
df_gene <- read.table("triadsBlockGenoypedGeneNumAddModel.txt.gz",header = T,sep = "\t")
df_gene_abd <- select(df_gene, A,B,D,genotypedGeneNumModel)
df_gene_abd$group <- seq(1,nrow(df_gene_abd),by = 1)

df_ABD <- gather(df_gene_abd, key=Sub, value = GeneNum,c(1:3))
head(df_ABD)
df_ABD$genotypedGeneNumModel <- factor(df_ABD$genotypedGeneNumModel,levels = c("M100","M010","M001","M011","M101","M110","M111","M000"))

col_model <- c('#fd8582','#967bce','#4bcdc6','#ffcbcc','#cccdfe','#cdfffc','darkgray','grey')

## genotyped gene num boxplot
ggplot(df_ABD,aes(x=Sub,y=GeneNum, fill=Sub))+
  # geom_line(alpha=0.05)+
  scale_fill_brewer(palette = "Set2")+
  geom_boxplot()+
  theme_minimal()+
  theme(legend.position = "none", text = element_text(size = 18),axis.title.x = element_blank())

## linechart
ggplot(df_ABD,aes(x=Sub,y=GeneNum, color=genotypedGeneNumModel, group=group))+
  geom_line(alpha=0.8)+
  # scale_fill_manual(values = col_model)+
  scale_color_manual(values = col_model)+
  facet_wrap(genotypedGeneNumModel~.,drop = F,ncol = 3)+
  # geom_boxplot()+
  theme_minimal()+
  theme(legend.position = "none",axis.title.x = element_blank(), text = element_text(size = 18))


## barplot
ggplot(df_ABD,aes(x=genotypedGeneNumModel, fill=genotypedGeneNumModel, group=1))+
  geom_bar(aes(y=..prop..))+
  scale_fill_manual(values = col_model)+
  theme_minimal()+
  theme(legend.position = "none", axis.title.x = element_blank(), text = element_text(size = 18))

```

## T statics distribution

### Two sample T-test (Evalution)

```{r}
df_t <- read.table("allTriadsBlockT.statisticsBySubspecies.txt.gz",header = T,sep = "\t", stringsAsFactors = T)
col_CLLR <- c("#9900ff","#fc6e6e")
```


#### T_equalVariances

##### Slightly

```{r}
df_t_slightly <- df_t %>% 
  filter(SlightlyOrStrongly=="slightly")
## distribution
ggplot(df_t_slightly,aes(x=T_equalVariances, fill=Group, color=Group))+
  # geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  geom_density(position = "dodge", aes(y=..density..), alpha=0.5)+
  labs(x="T statics",y="Density")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  facet_wrap(AdditiveOrDominance~.)+
  theme_minimal()+
  theme(legend.position = c(0.8,0.8),text = element_text(size = 18),
        legend.title = element_blank())

## boxplot
ggplot(df_t_slightly,aes(y=T_equalVariances, x=AdditiveOrDominance, fill=Group))+
  geom_boxplot(position = position_dodge(0.8))+
  labs(y="T statics")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  stat_summary(geom = "point",fun = mean,position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.1,0.9),text = element_text(size = 18),
        legend.title = element_blank(),axis.title.x = element_blank())
```

##### Strongly

```{r}
df_t_strongly <- df_t %>% 
  filter(SlightlyOrStrongly=="strongly")
## distribution
ggplot(df_t_strongly,aes(x=T_equalVariances, fill=Group, color=Group))+
  # geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  geom_density(position = "dodge", aes(y=..density..), alpha=0.5)+
  labs(x="T statics",y="Density")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  facet_wrap(AdditiveOrDominance~.)+
  theme_minimal()+
  theme(legend.position = c(0.8,0.8),text = element_text(size = 18),
        legend.title = element_blank())

## boxplot
ggplot(df_t_strongly,aes(y=T_equalVariances, x=AdditiveOrDominance, fill=Group))+
  geom_boxplot(position = position_dodge(0.8))+
  labs(y="T statics")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  stat_summary(geom = "point",fun = mean,position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.1,0.9),text = element_text(size = 18),
        legend.title = element_blank(),axis.title.x = element_blank())
```

#### T_notEqualVariances

##### Slightly

```{r}
df_t_slightly <- df_t %>% 
  filter(SlightlyOrStrongly=="slightly")
## distribution
ggplot(df_t_slightly,aes(x=T_notEqualVariances, fill=Group, color=Group))+
  # geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  geom_density(position = "dodge", aes(y=..density..), alpha=0.5)+
  labs(x="T statics",y="Density")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  facet_wrap(AdditiveOrDominance~.)+
  theme_minimal()+
  theme(legend.position = c(0.8,0.8),text = element_text(size = 18),
        legend.title = element_blank())

## boxplot
ggplot(df_t_slightly,aes(y=T_notEqualVariances, x=AdditiveOrDominance, fill=Group))+
  geom_boxplot(position = position_dodge(0.8))+
  labs(y="T statics")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  stat_summary(geom = "point",fun = mean,position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.1,0.9),text = element_text(size = 18),
        legend.title = element_blank(),axis.title.x = element_blank())
```


##### Strongly

```{r}
df_t_strongly <- df_t %>% 
  filter(SlightlyOrStrongly=="strongly")
## distribution
ggplot(df_t_strongly,aes(x=T_notEqualVariances, fill=Group, color=Group))+
  # geom_histogram(position = "dodge", bins = 50, aes(y=..density..), alpha=0.5)+
  geom_density(position = "dodge", aes(y=..density..), alpha=0.5)+
  labs(x="T statics",y="Density")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  facet_wrap(AdditiveOrDominance~.)+
  theme_minimal()+
  theme(legend.position = c(0.8,0.8),text = element_text(size = 18),
        legend.title = element_blank())

## boxplot
ggplot(df_t_strongly,aes(y=T_notEqualVariances, x=AdditiveOrDominance, fill=Group))+
  geom_boxplot(position = position_dodge(0.8))+
  labs(y="T statics")+
  scale_color_manual(values = col_CLLR)+
  scale_fill_manual(values = col_CLLR)+
  stat_summary(geom = "point",fun = mean,position = position_dodge(0.8), color="red")+
  theme_minimal()+
  theme(legend.position = c(0.1,0.9),text = element_text(size = 18),
        legend.title = element_blank(),axis.title.x = element_blank())
```




